import ITRF
import Matrix
import Earth

--
eps = 1.0e-7

delta :: Double -> Double -> Double
delta a b = abs (a-b)

--test of wsg2itrf
testW2I :: [Double] -> Bool
testW2I (lat:(lon:(h:xs))) =
  (all (<eps)) (zipWith delta (wgs2itrf [lat,lon,h]) xs)

resultSetOfW2I = [
  [0,180,0,-6378137,0.00000000078109650615733,0],
  [0,170,0,-6281238.76737403,1107551.86696002,0],
  [0,160,0,-5993488.27326157,2181451.33089075,0],
  [0,150,0,-5523628.67081747,3189068.5,0],
  [0,140,0,-4885936.40630155,4099787.43648328,0],
  [0,130,0,-4099787.43648327,4885936.40630155,0],
  [0,120,0,-3189068.5,5523628.67081747,0],
  [0,110,0,-2181451.33089075,5993488.27326157,0],
  [0,100,0,-1107551.86696002,6281238.76737403,0],
  [0,90,0,0.000000000390548253078665,6378137,0],
  [0,80,0,1107551.86696002,6281238.76737403,0],
  [0,70,0,2181451.33089075,5993488.27326157,0],
  [0,60,0,3189068.5,5523628.67081747,0],
  [0,50,0,4099787.43648328,4885936.40630155,0],
  [0,40,0,4885936.40630155,4099787.43648327,0],
  [0,30,0,5523628.67081747,3189068.5,0],
  [0,20,0,5993488.27326157,2181451.33089075,0],
  [0,10,0,6281238.76737403,1107551.86696002,0],
  [0,0,0,6378137,0,0],
  [0,-10,0,6281238.76737403,-1107551.86696002,0],
  [0,-20,0,5993488.27326157,-2181451.33089075,0],
  [0,-30,0,5523628.67081747,-3189068.5,0],
  [0,-40,0,4885936.40630155,-4099787.43648327,0],
  [0,-50,0,4099787.43648328,-4885936.40630155,0],
  [0,-60,0,3189068.5,-5523628.67081747,0],
  [0,-70,0,2181451.33089075,-5993488.27326157,0],
  [0,-80,0,1107551.86696002,-6281238.76737403,0],
  [0,-90,0,0.000000000390548253078665,-6378137,0],
  [0,-100,0,-1107551.86696002,-6281238.76737403,0],
  [0,-110,0,-2181451.33089075,-5993488.27326157,0],
  [0,-120,0,-3189068.5,-5523628.67081747,0],
  [0,-130,0,-4099787.43648327,-4885936.40630155,0],
  [0,-140,0,-4885936.40630155,-4099787.43648328,0],
  [0,-150,0,-5523628.67081747,-3189068.5,0],
  [0,-160,0,-5993488.27326157,-2181451.33089075,0],
  [0,-170,0,-6281238.76737403,-1107551.86696002,0],
  [22.5,180,0,-5895520.83217834,0.000000000721993071643375,2425656.97855599],
  [22.5,170,0,-5805954.62357422,1023746.4489052,2425656.97855599],
  [22.5,160,0,-5539977.42168759,2016386.8800011,2425656.97855599],
  [22.5,150,0,-5105670.80920682,2947760.41608917,2425656.97855599],
  [22.5,140,0,-4516230.97278239,3789567.74357312,2425656.97855599],
  [22.5,130,0,-3789567.74357312,4516230.97278239,2425656.97855599],
  [22.5,120,0,-2947760.41608917,5105670.80920682,2425656.97855599],
  [22.5,110,0,-2016386.8800011,5539977.42168759,2425656.97855599],
  [22.5,100,0,-1023746.44890519,5805954.62357422,2425656.97855599],
  [22.5,90,0,0.000000000360996535821688,5895520.83217834,2425656.97855599],
  [22.5,80,0,1023746.44890519,5805954.62357422,2425656.97855599],
  [22.5,70,0,2016386.8800011,5539977.42168759,2425656.97855599],
  [22.5,60,0,2947760.41608917,5105670.80920682,2425656.97855599],
  [22.5,50,0,3789567.74357312,4516230.97278239,2425656.97855599],
  [22.5,40,0,4516230.97278239,3789567.74357312,2425656.97855599],
  [22.5,30,0,5105670.80920682,2947760.41608917,2425656.97855599],
  [22.5,20,0,5539977.42168759,2016386.8800011,2425656.97855599],
  [22.5,10,0,5805954.62357422,1023746.44890519,2425656.97855599],
  [22.5,0,0,5895520.83217834,0,2425656.97855599],
  [22.5,-10,0,5805954.62357422,-1023746.44890519,2425656.97855599],
  [22.5,-20,0,5539977.42168759,-2016386.8800011,2425656.97855599],
  [22.5,-30,0,5105670.80920682,-2947760.41608917,2425656.97855599],
  [22.5,-40,0,4516230.97278239,-3789567.74357312,2425656.97855599],
  [22.5,-50,0,3789567.74357312,-4516230.97278239,2425656.97855599],
  [22.5,-60,0,2947760.41608917,-5105670.80920682,2425656.97855599],
  [22.5,-70,0,2016386.8800011,-5539977.42168759,2425656.97855599],
  [22.5,-80,0,1023746.44890519,-5805954.62357422,2425656.97855599],
  [22.5,-90,0,0.000000000360996535821688,-5895520.83217834,2425656.97855599],
  [22.5,-100,0,-1023746.44890519,-5805954.62357422,2425656.97855599],
  [22.5,-110,0,-2016386.8800011,-5539977.42168759,2425656.97855599],
  [22.5,-120,0,-2947760.41608917,-5105670.80920682,2425656.97855599],
  [22.5,-130,0,-3789567.74357312,-4516230.97278239,2425656.97855599],
  [22.5,-140,0,-4516230.97278239,-3789567.74357312,2425656.97855599],
  [22.5,-150,0,-5105670.80920682,-2947760.41608917,2425656.97855599],
  [22.5,-160,0,-5539977.42168759,-2016386.8800011,2425656.97855599],
  [22.5,-170,0,-5805954.62357422,-1023746.4489052,2425656.97855599],
  [41,45,0,3408672.59647348,3408672.59647348,4162423.20057805],
  [42,45,0,3356635.16078615,3356635.16078615,4245603.83599233],
  [43,45,0,3303569.86683697,3303569.86683697,4327501.75908732],
  [44,45,0,3249492.49386162,3249492.49386162,4408091.61233391],
  [45,45,0,3194419.14508682,3194419.14508682,4487348.4087548],
  [41,45,1000,3409206.25673548,3409206.25673548,4163079.25960704],
  [42,45,1000,3357160.64353165,3357160.64353165,4246272.96659868],
  [43,45,1000,3304087.01199883,3304087.01199883,4328183.75744739],
  [44,45,1000,3250001.14391242,3250001.14391242,4408786.27070437],
  [45,45,1000,3194919.14508682,3194919.14508682,4488055.51553599],
  [41,45,2000,3409739.91699749,3409739.91699748,4163735.31863603],
  [42,45,2000,3357686.12627715,3357686.12627715,4246942.09720504],
  [43,45,2000,3304604.15716069,3304604.15716069,4328865.75580745],
  [44,45,2000,3250509.79396322,3250509.79396321,4409480.92907483],
  [45,45,2000,3195419.14508682,3195419.14508682,4488762.62231717],
  [41,45,3000,3410273.57725949,3410273.57725949,4164391.37766502],
  [42,45,3000,3358211.60902265,3358211.60902265,4247611.2278114],
  [43,45,3000,3305121.30232255,3305121.30232255,4329547.75416751],
  [44,45,3000,3251018.44401401,3251018.44401401,4410175.58744528],
  [45,45,3000,3195919.14508682,3195919.14508682,4489469.72909836],
  [41,45,4000,3410807.23752149,3410807.23752149,4165047.43669402],
  [42,45,4000,3358737.09176815,3358737.09176815,4248280.35841776],
  [43,45,4000,3305638.44748442,3305638.44748441,4330229.75252757],
  [44,45,4000,3251527.09406481,3251527.09406481,4410870.24581574],
  [45,45,4000,3196419.14508682,3196419.14508682,4490176.83587955],
  [41,45,5000,3411340.89778349,3411340.89778349,4165703.49572301],
  [42,45,5000,3359262.57451365,3359262.57451364,4248949.48902412],
  [43,45,5000,3306155.59264628,3306155.59264628,4330911.75088764],
  [44,45,5000,3252035.74411561,3252035.74411561,4411564.9041862],
  [45,45,5000,3196919.14508682,3196919.14508682,4490883.94266073],
  [41,45,6000,3411874.55804549,3411874.55804549,4166359.554752],
  [42,45,6000,3359788.05725914,3359788.05725914,4249618.61963048],
  [43,45,6000,3306672.73780814,3306672.73780814,4331593.7492477],
  [44,45,6000,3252544.3941664,3252544.3941664,4412259.56255666],
  [45,45,6000,3197419.14508682,3197419.14508682,4491591.04944192],
  [45,45,6000,3197419.14508682,3197419.14508682,4491591.04944192]]

testI2W :: [Double] -> Bool
testI2W (x:(y:(z:xs))) =
  (all (<eps)) (zipWith delta (itrf2wgs [x,y,z]) xs)
  
resultSetOfI2W = [
  [-6378137,0.00000000078109650615733,0,0,180,0],
  [-6281238.76737403,1107551.86696002,0,0,170,0],
  [-5993488.27326157,2181451.33089075,0,0,160,0],
  [-5523628.67081747,3189068.5,0,0,150,0],
  [-4885936.40630155,4099787.43648328,0,0,140,0],
  [-4099787.43648327,4885936.40630155,0,0,130,0],
  [-3189068.5,5523628.67081747,0,0,120,0],
  [-2181451.33089075,5993488.27326157,0,0,110,0],
  [-1107551.86696002,6281238.76737403,0,0,100,0],
  [0.000000000390548253078665,6378137,0,0,90,0],
  [1107551.86696002,6281238.76737403,0,0,80,0],
  [2181451.33089075,5993488.27326157,0,0,70,0],
  [3189068.5,5523628.67081747,0,0,60,0],
  [4099787.43648328,4885936.40630155,0,0,50,0],
  [4885936.40630155,4099787.43648327,0,0,40,0],
  [5523628.67081747,3189068.5,0,0,30,0],
  [5993488.27326157,2181451.33089075,0,0,20,0],
  [6281238.76737403,1107551.86696002,0,0,10,0],
  [6378137,0,0,0,0,0],
  [6281238.76737403,-1107551.86696002,0,0,-10,0],
  [5993488.27326157,-2181451.33089075,0,0,-20,0],
  [5523628.67081747,-3189068.5,0,0,-30,0],
  [4885936.40630155,-4099787.43648327,0,0,-40,0],
  [4099787.43648328,-4885936.40630155,0,0,-50,0],
  [3189068.5,-5523628.67081747,0,0,-60,0],
  [2181451.33089075,-5993488.27326157,0,0,-70,0],
  [1107551.86696002,-6281238.76737403,0,0,-80,0],
  [0.000000000390548253078665,-6378137,0,0,-90,0],
  [-1107551.86696002,-6281238.76737403,0,0,-100,0],
  [-2181451.33089075,-5993488.27326157,0,0,-110,0],
  [-3189068.5,-5523628.67081747,0,0,-120,0],
  [-4099787.43648327,-4885936.40630155,0,0,-130,0],
  [-4885936.40630155,-4099787.43648328,0,0,-140,0],
  [-5523628.67081747,-3189068.5,0,0,-150,0],
  [-5993488.27326157,-2181451.33089075,0,0,-160,0],
  [-6281238.76737403,-1107551.86696002,0,0,-170,0],
  [-5895520.83217834,0.000000000721993071643375,2425656.97855599,22.5,180,0],
  [-5805954.62357422,1023746.4489052,2425656.97855599,22.5,170,0],
  [-5539977.42168759,2016386.8800011,2425656.97855599,22.5,160,0],
  [-5105670.80920682,2947760.41608917,2425656.97855599,22.5,150,0],
  [-4516230.97278239,3789567.74357312,2425656.97855599,22.5,140,0],
  [-3789567.74357312,4516230.97278239,2425656.97855599,22.5,130,0],
  [-2947760.41608917,5105670.80920682,2425656.97855599,22.5,120,0],
  [-2016386.8800011,5539977.42168759,2425656.97855599,22.5,110,0],
  [-1023746.44890519,5805954.62357422,2425656.97855599,22.5,100,0],
  [0.000000000360996535821688,5895520.83217834,2425656.97855599,22.5,90,0],
  [1023746.44890519,5805954.62357422,2425656.97855599,22.5,80,0],
  [2016386.8800011,5539977.42168759,2425656.97855599,22.5,70,0],
  [2947760.41608917,5105670.80920682,2425656.97855599,22.5,60,0],
  [3789567.74357312,4516230.97278239,2425656.97855599,22.5,50,0],
  [4516230.97278239,3789567.74357312,2425656.97855599,22.5,40,0],
  [5105670.80920682,2947760.41608917,2425656.97855599,22.5,30,0],
  [5539977.42168759,2016386.8800011,2425656.97855599,22.5,20,0],
  [5805954.62357422,1023746.44890519,2425656.97855599,22.5,10,0],
  [5895520.83217834,0,2425656.97855599,22.5,0,0],
  [5805954.62357422,-1023746.44890519,2425656.97855599,22.5,-10,0],
  [5539977.42168759,-2016386.8800011,2425656.97855599,22.5,-20,0],
  [5105670.80920682,-2947760.41608917,2425656.97855599,22.5,-30,0],
  [4516230.97278239,-3789567.74357312,2425656.97855599,22.5,-40,0],
  [3789567.74357312,-4516230.97278239,2425656.97855599,22.5,-50,0],
  [2947760.41608917,-5105670.80920682,2425656.97855599,22.5,-60,0],
  [2016386.8800011,-5539977.42168759,2425656.97855599,22.5,-70,0],
  [1023746.44890519,-5805954.62357422,2425656.97855599,22.5,-80,0],
  [0.000000000360996535821688,-5895520.83217834,2425656.97855599,22.5,-90,0],
  [-1023746.44890519,-5805954.62357422,2425656.97855599,22.5,-100,0],
  [-2016386.8800011,-5539977.42168759,2425656.97855599,22.5,-110,0],
  [-2947760.41608917,-5105670.80920682,2425656.97855599,22.5,-120,0],
  [-3789567.74357312,-4516230.97278239,2425656.97855599,22.5,-130,0],
  [-4516230.97278239,-3789567.74357312,2425656.97855599,22.5,-140,0],
  [-5105670.80920682,-2947760.41608917,2425656.97855599,22.5,-150,0],
  [-5539977.42168759,-2016386.8800011,2425656.97855599,22.5,-160,0],
  [-5805954.62357422,-1023746.4489052,2425656.97855599,22.5,-170,0],
  [3408672.59647348,3408672.59647348,4162423.20057805,41,45,0],
  [3356635.16078615,3356635.16078615,4245603.83599233,42,45,0],
  [3303569.86683697,3303569.86683697,4327501.75908732,43,45,0],
  [3249492.49386162,3249492.49386162,4408091.61233391,44,45,0],
  [3194419.14508682,3194419.14508682,4487348.4087548,45,45,0],
  [3409206.25673548,3409206.25673548,4163079.25960704,41,45,1000],
  [3357160.64353165,3357160.64353165,4246272.96659868,42,45,1000],
  [3304087.01199883,3304087.01199883,4328183.75744739,43,45,1000],
  [3250001.14391242,3250001.14391242,4408786.27070437,44,45,1000],
  [3194919.14508682,3194919.14508682,4488055.51553599,45,45,1000],
  [3409739.91699749,3409739.91699748,4163735.31863603,41,45,2000],
  [3357686.12627715,3357686.12627715,4246942.09720504,42,45,2000],
  [3304604.15716069,3304604.15716069,4328865.75580745,43,45,2000],
  [3250509.79396322,3250509.79396321,4409480.92907483,44,45,2000],
  [3195419.14508682,3195419.14508682,4488762.62231717,45,45,2000],
  [3410273.57725949,3410273.57725949,4164391.37766502,41,45,3000],
  [3358211.60902265,3358211.60902265,4247611.2278114,42,45,3000],
  [3305121.30232255,3305121.30232255,4329547.75416751,43,45,3000],
  [3251018.44401401,3251018.44401401,4410175.58744528,44,45,3000],
  [3195919.14508682,3195919.14508682,4489469.72909836,45,45,3000],
  [3410807.23752149,3410807.23752149,4165047.43669402,41,45,4000],
  [3358737.09176815,3358737.09176815,4248280.35841776,42,45,4000],
  [3305638.44748442,3305638.44748441,4330229.75252757,43,45,4000],
  [3251527.09406481,3251527.09406481,4410870.24581574,44,45,4000],
  [3196419.14508682,3196419.14508682,4490176.83587955,45,45,4000]
  ]
