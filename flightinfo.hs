import Matrix
import Aerial
import Data.List

-- フライト情報
-- フライト情報の各角度はDegreeにしましょう。tppryに渡す時にradianに変換。
--
--
data FlightInfo = FI { pitch :: Double,
                       roll :: Double,
                       yaw :: Double,
                       pan :: Double,
                       tilt :: Double }
  deriving(Eq,Show)

-- 登録は連想リストで
-- 連想リスト
-- FI { pitch = 1.0, roll = 3.0, yaw = 1.0, pan = 1.0, tilt = -140.0 }
-- 後で他を追加する。
-- このflightinfoでIdenticalFrameからWorldFrameを計算。
-- degreeからradianに変換。

fi2w :: FlightInfo -> Frame
fi2w f = tppry (toR (yaw f))
  (toR (roll f))
  (toR (pitch f))
  (toR (pan f))
  (toR (tilt f)) ident

frdot :: Frame -> Frame -> Double
frdot a b = dot (los a) (los b)

frdots :: [Frame] -> [Double]
frdots (a:[]) = []
frdots (a:b) = (frdot a (head b)) : (frdots b)

-- 光軸
los :: Frame -> [Double]
los (FR x _ _) = x

-- 光軸[x,y,z]からNED(North-East-Down)に変換
ned :: [Double] -> [Double]
ned [x,y,z] = [(atan2 y x),(atan2 z (sqrt(y^2+x^2)))]

testfr = [FR [3.949062636960793e-2,0.2498161648113023,0.9674876610210119] [-0.9663092443910738,0.25599945387063744,-2.6659404012227876e-2] [-0.25433626291444933,-0.9338394741158179,0.2515092482391145],FR [-8.880833493161142e-3,0.18348355872503763,0.982982662346627] [-0.9950440738249006,-9.898134116592507e-2,9.486055394146087e-3] [9.903747746390155e-2,-0.9780268287621718,0.18345326456347621],FR [6.197909331224279e-3,0.10273980673467986,0.9946889554187494] [-0.998478009513411,-5.387713137579854e-2,1.1786400334784407e-2] [5.480192002164509e-2,-0.9932480993321033,0.10224951215094208],FR [1.179336809258831e-2,0.16132277468372647,0.9868312311826055] [-0.9998738055293624,-8.602485908021582e-3,1.3355532652538978e-2] [1.0643753344730653e-2,-0.9868642052504215,0.16120096435874892],FR [-1.3693012875733518e-2,0.25071559480900163,0.9679639414347796] [-0.9661962392864397,-0.25256070657430124,5.1748591125073615e-2] [0.2574438357916642,-0.9345345258545872,0.2456987818419465],FR [-0.12012157000389473,0.24826026950420788,0.9612167533941018] [-0.7121394208970347,-0.6961410461093902,9.080247312799064e-2] [0.6916850826960455,-0.673613006486233,0.260417479959282],FR [-6.96560172330318e-2,0.29110695383260354,0.9541513405605706] [-0.9060243267271813,-0.41871780250924134,6.1606178589402545e-2] [0.41745413956719735,-0.8601930848897439,0.2929161963191462],FR [-4.687062423346641e-2,0.3037250226584405,0.9516061449964973] [-0.9567830704771102,-0.2873633123115859,4.4592407265216016e-2] [0.287000523749275,-0.9083905753300412,0.30406785758971316],FR [2.574214744793251e-2,0.3177611517282998,0.9478212871090592] [-0.9994482198212473,2.808912153247079e-2,1.772729950312329e-2] [-2.099042021752427e-2,-0.9477546368674956,0.3183088917313703],FR [2.463544123016236e-2,0.3170443273635675,0.948090707433618] [-0.99906783358438,-2.5820320002780717e-2,3.459443556364964e-2] [3.544797501139833e-2,-0.948059178301406,0.3161126943133638],FR [2.2409784247139027e-2,0.31709893268118555,0.948127664643559] [-0.9990801754410458,-2.757743858301724e-2,3.283729467981289e-2] [3.655960353567357e-2,-0.9479914302216306,0.3161892528465532],FR [2.1097092966510595e-2,0.3169942879471605,0.9481927726349928] [-0.9985790707807712,-3.9740487715430206e-2,3.550398618115028e-2] [4.89362040515402e-2,-0.9475944887160397,0.3157054527372208],FR [1.9364001150443837e-2,0.31651130569766034,0.9483910737796978] [-0.9967954625551405,-6.752389864928396e-2,4.2887398390259915e-2] [7.761340920826279e-2,-0.9461823907031686,0.3141895005157036],FR [1.735978058675989e-2,0.3163641008743376,0.9484789895912041] [-0.9956470793230976,-8.141106642882395e-2,4.537765637742101e-2] [9.157254748758079e-2,-0.9451380819440584,0.31357371478767343],FR [1.5225898127652238e-2,0.3165446213562284,0.9484554152497884] [-0.9950521946941672,-8.834395302285764e-2,4.545850633947622e-2] [9.817994632575146e-2,-0.9444547891004298,0.3136333041702291],FR [1.4826148271485037e-2,0.31582195022189646,0.9487026304830563] [-0.9968417368389975,-6.93630605947742e-2,3.8669335664539416e-2] [7.80175430479779e-2,-0.9462796952185777,0.31379611437013255],FR [1.2943634046386522e-2,0.31579925918413115,0.9487377352231897] [-0.9959985875951703,-7.983585958278741e-2,4.016278169030389e-2] [8.84266693147423e-2,-0.9454612966290221,0.31350224996077736],FR [1.3049907030072028e-2,0.3134409146411517,0.9495180319274746] [-0.9938163014211898,-0.1006527700820581,4.688474063397541e-2] [0.11026721614339083,-0.9442583401292924,0.3101891812108541],FR [1.0725950443420826e-2,0.31499993759002404,0.9490310813168166] [-0.9947026263659762,-9.367254063087113e-2,4.2333677284014444e-2] [0.10223325822702983,-0.9444577780134158,0.31232653819719947],FR [1.147571928713808e-2,0.31364135310483515,0.9494721741522552] [-0.9962294913200468,-7.80742782172965e-2,3.7831305886120103e-2] [8.599481665219019e-2,-0.9463263225248553,0.3115628071601934],FR [9.57287653043291e-3,0.31410669024763105,0.9493394267471527] [-0.9977022593080843,-6.0679012493615556e-2,3.0137339204784373e-2] [6.707131880675726e-2,-0.9474465919430386,0.3128040818292559],FR [8.942554469467533e-3,0.3135712701111456,0.9495225585948153] [-0.9958463377509033,-8.325005003362801e-2,3.687140840153342e-2] [9.060961487433242e-2,-0.9459082871665105,0.31152433285707193],FR [9.178238687050352e-3,0.31354987028022546,0.9495273765310073] [-0.9953238495519973,-8.8446903737713e-2,3.8827564077659416e-2] [9.615713414820845e-2,-0.9454436123145927,0.31127187712020826],FR [6.320769392716169e-3,0.3123862275213648,0.94993415178593] [-0.9910314512560032,-0.1248446743462364,4.764944814793065e-2] [0.13347925118048964,-0.9417158022154839,0.3087954620164348],FR [5.312489654094726e-3,0.3107607333379235,0.9504733263321761] [-0.9910969480453578,-0.12481461894860546,4.6348144211952526e-2] [0.1330361493311223,-0.9422574369629516,0.307330938011709],FR [4.470598912388574e-3,0.31166012051032677,0.950183131311461] [-0.9940194453043275,-0.102293136211832,3.822900261352105e-2] [0.1091116680389479,-0.9446714156612535,0.30933890852966156],FR [3.060003113062787e-3,0.3106031325414389,0.950534760246249] [-0.9902214695665015,-0.13163183323406413,4.620066762502277e-2] [0.13947070513375326,-0.9413813013518406,0.3071630965376679],FR [4.503588015519061e-4,0.31163059789574793,0.9502032243852305] [-0.9931590013064314,-0.11081490078620393,3.681380023517978e-2] [0.1167689826150841,-0.9437194647875409,0.309448826916755],FR [1.3046512762470291e-3,0.30900090521603224,0.9510608489790334] [-0.9879061172311919,-0.14706182184849279,4.9135772017875674e-2] [0.1550477391716431,-0.9396229356131505,0.30507202009933204],FR [-2.0237465042584474e-3,0.3102510738937965,0.9506524999166797] [-0.9853759440889481,-0.16259378291895582,5.096577839018673e-2] [0.17038237368020395,-0.9366469627900629,0.3060429934425062],FR [-2.919502760581283e-3,0.3087549686938077,0.9511371330205317] [-0.986048736448774,-0.15918914790900718,4.864878760853797e-2] [0.16643126464522032,-0.9377255379346827,0.3049121999095848],FR [-5.0002552290693e-3,0.30952341045718296,0.9508786756608849] [-0.9900758633909584,-0.13508181585313597,3.876451671912505e-2] [0.14044494358392556,-0.9412481933075747,0.30712710140418137],FR [-3.7247856067746943e-3,0.30941021116956324,0.9509213675147856] [-0.9902869229931236,-0.1333107314902587,3.9497582436692824e-2] [0.1389889784155376,-0.9415378750180678,0.30690143985564305],FR [-6.177191325574108e-3,0.3097834806646771,0.9507870620778371] [-0.9853133232209338,-0.1641381997817154,4.7077664085396015e-2] [0.17064435938713868,-0.9365323520731654,0.30624770387654765],FR [-8.877999707892811e-3,0.3073174081722983,0.9515656528876224] [-0.9750779013457658,-0.2136250972880281,5.9894942322515965e-2] [0.22168506361124932,-0.9273188925299329,0.30155497695898653],FR [-8.883355547231686e-3,0.30658884662299013,0.9518005910486746] [-0.9767303129429875,-0.20663510232832533,5.744414908462403e-2] [0.21428714794059736,-0.9291421923538654,0.3012902331894238],FR [-1.0329500718354825e-2,0.30544421448093445,0.9521539440946692] [-0.9771900890936843,-0.20507126376507306,5.51842962705289e-2] [0.21211513664042742,-0.9298653712328043,0.30059534292815004],FR [-1.0586190089958467e-2,0.30645612749579115,0.9518259160685125] [-0.9805242948983744,-0.18986708049996676,5.022548015166012e-2] [0.19611231397702938,-0.9327567387388326,0.3024976473360951],FR [-1.1899365996133185e-2,0.30637148531924385,0.9518376532120225] [-0.9809163126497092,-0.1883219975988299,4.835300195525295e-2] [0.19406594927134552,-0.9330977109626122,0.30276570005491854],FR [-1.2662324195009483e-2,0.3066579689645,0.9517355492029014] [-0.9830455123074825,-0.17794096286978622,4.425533261758002e-2] [0.18292399043892454,-0.9350389851784477,0.3037118863633082],FR [-1.2672931543645266e-2,0.3042628409178444,0.9525038164977044] [-0.9715999543196935,-0.22885019757519687,6.0175708020457234e-2] [0.2362899184731757,-0.9246900619701695,0.29852196522457797],FR [-4.898008412129187e-3,0.30628288047026553,0.9519279419391113] [-0.9727664939670597,-0.22206017837724082,6.644264740437654e-2] [0.2317355340223615,-0.9256781699434773,0.29902937641888283],FR [1.1790450657853876e-2,0.3110297094490993,0.9503270516581613] [-0.994678032417408,-9.363631547572716e-2,4.298665200226537e-2] [0.10235524949663538,-0.9457762738957556,0.3082704050607884],FR [1.8402445889278744e-2,0.3110860306086683,0.9502035737385095] [-0.9954341190642253,-8.332602968110776e-2,4.6558429745994376e-2] [9.366036828948365e-2,-0.9467218463401623,0.3081322460797514],FR [1.9621646251364172e-2,0.31254222577725127,0.949701188850782] [-0.9961903536301864,-7.461487776110425e-2,4.5137560311342605e-2] [8.496923168153837e-2,-0.9469688364053473,0.3098874836848882],FR [2.085159519856632e-2,0.31264807226948915,0.9496401391494822] [-0.9978834788871195,-5.200897007945306e-2,3.903369820314537e-2] [6.159361608003547e-2,-0.9484441206193683,0.31090187603283836],FR [1.9509681095419423e-2,0.312044201299458,0.9498672479767573] [-0.9955575457046931,-8.146395491040641e-2,4.7210139173729196e-2] [9.211159283175298e-2,-0.9465685609007615,0.30906862341599634],FR [1.9292877438038324e-2,0.31110280289223113,0.9501804201901649] [-0.9979507295134231,-5.199936390732671e-2,3.728816993176405e-2] [6.10092316275786e-2,-0.9489526395905283,0.3094620517452526],FR [1.7052459496982947e-2,0.31097045576217475,0.9502665885256458] [-0.9970428779483124,-6.593683952629859e-2,3.946938973217109e-2] [7.493138966848686e-2,-0.9481295844115131,0.30892649288463575],FR [1.8411817825956304e-2,0.31138180431425266,0.9501065081907101] [-0.9980889019407226,-5.0339514277672914e-2,3.583960274682303e-2] [5.898770030358804e-2,-0.9489506337235296,0.30985988118600594],FR [1.5499442171942164e-2,0.31158707237646643,0.9500911870027118] [-0.9983984126082162,-4.688341252985053e-2,3.166315415352685e-2] [5.440934656612567e-2,-0.949060294163347,0.31036137170857564]]



